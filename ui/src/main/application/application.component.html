<div class="application-container">
  <div class="application-header">
    <div class="header-actions">
      <div class="search-group">
        <x-input-group compact>
          <x-input
            class="search-input"
            placeholder="搜索应用名称..."
            [(ngModel)]="keyword"
            (keyup.enter)="search(keyword)"
            clearable
          ></x-input>
          <x-button icon="fto-search" (click)="search(keyword)">搜索</x-button>
          <x-button type="text" icon="fto-refresh-cw" (click)="resetSearch()">重置</x-button>
        </x-input-group>
      </div>
      <div class="action-buttons">
        <x-button type="primary" icon="fto-plus" (click)="action('add')">新增</x-button>
        <x-button type="danger" icon="fto-trash-2" (click)="action('delete')">删除</x-button>
      </div>
    </div>
  </div>
  <div class="application-table">

    <x-table
      #tableCom
      au-adaption
      [columns]="columns"
      [data]="data"
      [size]="size"
      [index]="index"
      [query]="query"
      [showPagination]="true"
      [bordered]="false"
      [showHeader]="true"
      [bodyColumnTpl]="{
        actions: actionsTpl,
        image: imageTpl,
        rating: ratingTpl,
        isPinned: pinnedTpl
      }"
      (headCheckboxChange)="headCheckboxChange($event)"
      (bodyCheckboxChange)="bodyCheckboxChange($event)"
      loading
    ></x-table>
  </div>
</div><ng-template #actionsTpl let-column="$column" let-row="$row">
  <div class="au-table-actions">
    <x-link icon="fto-external-link" (click)="action('visit', row)" title="访问" type="info"></x-link>
    <x-link icon="fto-eye" (click)="action('info', row)" title="查看" type="info"></x-link>
    <x-link icon="fto-edit" (click)="action('edit', row)" title="修改" type="primary"></x-link>
    <x-link icon="fto-trash-2" (click)="action('delete', row)" title="删除" type="danger"></x-link>
  </div>
</ng-template>

<ng-template #imageTpl let-column="$column" let-row="$row">
  <div class="app-image-container">
    <img [src]="row.image" [alt]="row.name" class="app-table-image" *ngIf="row.image" />
    <x-icon type="fto-image" *ngIf="!row.image"></x-icon>
  </div>
</ng-template>

<ng-template #ratingTpl let-column="$column" let-row="$row">
  <div class="rating-display">
    <span class="rating-stars">{{getStarRating(row.rating)}}</span>
    <span class="rating-value">{{row.rating | number:'1.1-1'}}</span>
  </div>
</ng-template>

<ng-template #pinnedTpl let-column="$column" let-row="$row">
  {{isPinnedText(row.isPinned)}}
</ng-template>
